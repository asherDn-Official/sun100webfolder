import{b8 as P,R as _,M as f,Q as w,V as g,j as l}from"./index-4567d11c.js";import{u as T}from"./use-utils-f92e6887.js";const B={"Bank Transfer":"//images/bank.jpeg",UPI:"//images/upi.jpeg"},z=()=>{const{data:r,isFetching:a}=P(["p2pcoinList"],"getP2Pcoins");return{p2pcoinpair:r,loading:a}},E=r=>{const a=w,[$,m]=_.useState(),{send:c}=T(),{loading:q,add:d,get:y,set:o,update:i}=f(!0);return{payment:$,loading:q,init:(e,s,t)=>{o(`users/${e}/p2p_trade_messages`,t,{init:"initiated",tradeId:t,tradeUid:s,uid:r})},trade:async e=>{await d(`users/${r}/p2p_trades`,e).then(()=>a({message:"Order posted successfully!",variant:"success"})).catch(s=>a({message:s.message,variant:"error"}))},edit:async(e,s)=>{await i(`users/${r}/p2p_trades`,e,{...s,isEdited:1}).then(()=>a({message:"Order Post Updated successfully!",variant:"success"})).catch(t=>a({message:t.message,variant:"error"}))},cancel:async e=>{await i(`users/${r}/p2p_trades`,e,{status:"cancelled",orderCancelledAt:new Date().getTime(),isEdited:1}).then(()=>a({message:"Order Post cancelled successfully!",variant:"success"})).catch(s=>a({message:s.message,variant:"error"}))},pay:async(e,s)=>{const t={topic:"trade",message:"Buyer Paid for your order",is_Read:!1,createdTime:new Date().getTime(),attributes:{coin:e.coin,currency:e.currency,coinId:`${e.coin}/${e.currency}`,tradeId:e.tradeId,requestuid:e.requestuid}};await i(`users/${e.uid}/p2p_trades/${e.tradeId}/requests`,`${e.requestuid}_${e.requestPlacedTime}`,{status:"ongoing"}),await i(`users/${e==null?void 0:e.requestuid}/p2p_request_trades`,`${e.tradeId}_${e.requestPlacedTime}`,{requestStatus:"ongoing"}),await i(`users/${e.uid}/p2p_trades/${e.tradeId}/requests`,`${e.requestuid}_${e.requestPlacedTime}`,{status:"ongoing"}),await i(`users/${e.requestuid}/p2p_trade_messages`,`${e.tradeId}_${e.requestPlacedTime}`,{...s,paid:!0}).then(()=>a({message:"Payment receipt updated successfully!",variant:"success"})).catch(u=>a({message:u.message,variant:"error"})),await d(`users/${e.uid}/notifications`,t),await c(r,"Payment Details","Payment Successfull",`Trade Request ID : ${e.requestTradeId} <br/>You paid for this trade request`),await c(r===(e==null?void 0:e.tradeuid)?e==null?void 0:e.requestuid:(e==null?void 0:e.tradeuid)||"","Payment Details","Payment Recieved",`Trade Request ID : ${e.requestTradeId} <br/>Payment received for this trade request`)},payemntDetials:async(e,s,t,u)=>{try{await y(`users/${s}/payment_details`,e.replaceAll(" ","_").toLowerCase()).then(n=>m(p=>t?u?{...p,[e]:n.data()}:{...p,...n.data()}:u?{[e]:n.data()}:n.data()))}catch{m({})}},updatePayment:async(e,s)=>await o(`users/${r}/payment_details`,e.replace(" ","_").toLowerCase(),s).then(()=>a({message:"Payment Details updated successfully!",variant:"success"})).catch(t=>a({message:t.message,variant:"error"})),sendMessage:async(e,s,t,u)=>{e.message.trim().length||e.image?(await d(`users/${t}/p2p_trade_messages/${s}/messages`,{...e,uid:r}),await c(u,"New Message from P2P trade","New Message from P2P trade",`Trade Request ID : ${s.split("_")[0]} <br/> Message : ${e.message}`)):a({message:"Message can't be empty",variant:"error"})},tradeAccept:async(e,s)=>{await i(`users/${e.uid}/p2p_trades/${e.tradeId}/requests`,s,{status:"confirmed",confirmedTime:new Date().getTime()}).then(()=>a({message:"Order Accepted successfully!",variant:"success"})).catch(t=>a({message:t.message,variant:"error"}))},tradeConfirm:async(e,s)=>{await i(`users/${e.uid}/p2p_trades/${e.tradeId}/requests`,s,{status:"paid",confirmedTime:new Date().getTime()}).then(()=>a({message:"Order Confirmed successfully!",variant:"success"})).catch(t=>a({message:t.message,variant:"error"}))},tradeDispute:async e=>{try{await i(`users/${e.requestuid}/p2p_request_trades`,`${e.tradeId}_${e.requestPlacedTime}`,{dispute:!0,requestStatus:"dispute",disputeRaisedUid:r,disputedTime:new Date().getTime()}),await i(`users/${e.uid}/p2p_trades/${e.tradeId}/requests`,`${e.requestuid}_${e.requestPlacedTime}`,{status:"dispute"}),await i("p2p_trade_book",`${e.orderPlacedTime}`,{status:"dispute"}),await c(e.tradeuid,"P2P Dispute","Dispute Raised",`Trade Request ID : ${e.requestTradeId} <br/>${r===e.tradeuid?"You":e.requestUname} raised dispute for this trade request`),await c(e.requestuid,"P2P Dispute","Dispute Raised",`Trade Request ID : ${e.requestTradeId} <br/>${r===e.requestuid?"You":e.username} raised dispute for this trade request`),a({message:"Dispute raised!",variant:"success"})}catch(s){a({message:s.message,variant:"error"})}},tradeRequest:async(e,s,t)=>{await o(`users/${r}/p2p_request_trades`,`${t}_${e.requestPlacedTime}`,{...e,requestStatus:"pending",requestuid:r,tradeuid:s}).then(()=>a({message:"Order requested successfully!",variant:"success"})).catch(u=>a({message:u.message,variant:"error"}))},tradeRequestCancel:async(e,s,t)=>{await i(`users/${s}/p2p_trades/${e}/requests`,t,{status:"cancelled"})}}},N=g(l.jsx("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"}),"Star"),Y=g(l.jsx("path",{d:"m22 9.24-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28z"}),"StarBorder");export{B as P,N as S,Y as a,z as b,E as u};
