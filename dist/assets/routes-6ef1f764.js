import{b8 as Q,V as se,j as e,H as M,p as A,S as w,G as b,m as N,F as v,T as h,I as O,R as y,aD as re,aE as _,au as W,aR as G,b9 as ne,l as k,aP as P,aZ as oe,aQ as ae,L as ie,N as D,Q as K,K as le,aI as ce,ba as V,aJ as $,aL as J,D as L,ax as Y,aM as de,aO as me,W as R,a4 as xe,r as ue,U as Z,bb as he,B as S,bc as pe,bd as ge,v as je,$ as z,t as X,f as T,aG as F,q as be,O as we,a5 as ye}from"./index-7c4d6238.js";import{u as ve}from"./use-kyc-13387bf9.js";import{A as H,T as Ce,a as Ie,D as ee}from"./timer-57f48d2a.js";import{S as ke}from"./select-field-17787c0d.js";import{u as fe}from"./use-utils-2db32e46.js";import{R as Te}from"./recent-transactions-bffa7fc2.js";import{I as Ae}from"./intro-a059d009.js";import{R as Ne}from"./responsive-table-51bed081.js";import{N as We}from"./nft-network-c611ac19.js";import{B as Se}from"./ButtonGroup-4590fad5.js";import"./CopyAll-d6231e8c.js";import"./TableRow-2a5a6a71.js";import"./Pagination-2b50fa8d.js";import"./Collapse-5b962d82.js";const Me=t=>{const{data:c,isFetching:p}=Q(["getCurrencyChains",localStorage.getItem("accessToken")||"",t],"getCurrencyChains",{currency:t});return{chains:c,loading:p}},$e=(t,c,p)=>{const{data:n,isFetching:m}=Q(["getWalletAddress",localStorage.getItem("accessToken")||"",t,p],"getWalletAddress",{coinId:t,type:c,network:p});return{walletDetail:n,loading:m}},Fe=se(e.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"}),"ContentCopy"),Re=({nfts:t,account:c,syncedAccount:p,form:n=!1,hide:m=!1})=>{const d=M(),a=s=>{d(`${s==null?void 0:s.contract}/${s==null?void 0:s.tokenId}/sale`,{state:s})};return p?t===void 0?e.jsx(A,{}):e.jsx(w,{justifyContent:"center",alignItems:"center",spacing:2,sx:{p:2},children:e.jsx(b,{container:!0,spacing:2,justifyContent:"center",alignItems:"center",children:t!=null&&t.length?t.map(s=>{var j,o;return e.jsx(b,{item:!0,xs:12,md:4,children:e.jsx(We,{account:c,id:s==null?void 0:s.tokenId,image:(s==null?void 0:s.tokenURI)||"",name:((j=s==null?void 0:s.metadata)==null?void 0:j.name)||"",subname:(o=s==null?void 0:s.metadata)==null?void 0:o.description,price:(s==null?void 0:s.sale)||(s==null?void 0:s.isAuction),onClick:n?()=>{var g;return(g=document==null?void 0:document.getElementById(`${s==null?void 0:s.tokenId}_${s==null?void 0:s.contract}_NFT`))==null?void 0:g.click()}:()=>{m?d(`${N.base}nft/sell`):c===p&&s&&a(s)},form:void 0,value:n?null:e.jsx(v,{number:s==null?void 0:s.price,type:"coin",coin:"ETH"})},s==null?void 0:s.tokenId)},s==null?void 0:s.tokenId)}):e.jsx(w,{justifyContent:"center",alignItems:"center",spacing:2,sx:{p:2},children:e.jsx(h,{variant:"h6",textAlign:"center",children:"No NFTs available in your Account"})})})}):e.jsxs(w,{justifyContent:"center",alignItems:"center",spacing:2,sx:{p:2},children:[e.jsx(h,{variant:"h6",children:"No NFTs to show"}),e.jsx(h,{variant:"body2",children:"Connect your wallet to show the list"})]})},ze=({chainList:t,verified:c})=>{var x;const{state:n}=O(),[m,d]=y.useState(!1),a=K,{values:s,setFieldValue:j}=re(),o=y.useMemo(()=>{var i;return(i=t==null?void 0:t.split(";"))==null?void 0:i.map(r=>r===s.blockChain)},[s.blockChain]);y.useEffect(()=>{j("finalWithdrawAmount",+s.amount-((o==null?void 0:o.withdrawalMinFee)||0))},[s.amount,o==null?void 0:o.withdrawalMinFee]);const g=()=>{d(!0),setTimeout(()=>{d(!1)},12e4),D("twoStepVerification").then(i=>{a({variant:i.error==="true"?"error":"success",message:i.message})})};return e.jsxs(b,{container:!0,spacing:2,marginY:1,children:[e.jsx(b,{item:!0,xs:12,sm:6,children:e.jsx(ke,{label:"Network",name:"blockChain",children:(x=t==null?void 0:t.split(";"))==null?void 0:x.map(i=>e.jsx(_,{value:i,disabled:i.toUpperCase().includes("Currently unavailable"),children:i==null?void 0:i.toUpperCase()},i))})}),e.jsx(b,{item:!0,xs:12,sm:6,children:e.jsx(H,{label:"Withdraw Amount",name:"amount",InputProps:{endAdornment:e.jsx(W,{position:"end",children:e.jsx(h,{variant:"caption",color:"primary",fontWeight:"bold",children:n.coin})})}})}),e.jsx(b,{item:!0,xs:12,sm:6,children:e.jsx(G,{size:"small",type:"text",label:"Withdraw Address",name:"toAddress"})}),e.jsx(b,{item:!0,xs:12,sm:6,children:e.jsx(H,{disabled:!0,label:"Final Withdraw Amount",name:"finalWithdrawAmount",InputProps:{endAdornment:e.jsx(W,{position:"end",children:e.jsx(h,{variant:"caption",color:"primary",fontWeight:"bold",children:n.coin})})}})}),e.jsx(b,{item:!0,xs:12,sm:12,children:e.jsx(G,{name:"otp",label:"Enter OTP",onPaste:i=>(i.preventDefault(),!1),onCopy:i=>(i.preventDefault(),!1),InputProps:{inputComponent:ne,endAdornment:e.jsx(W,{position:"end",children:e.jsx(k,{variant:"contained",sx:{mr:-1.5},onClick:g,disabled:m,children:m?e.jsx(Ce,{color:"inherit",time:new Date().getTime()+12e4}):"Get OTP"})})}})}),e.jsx(b,{item:!0,xs:12,sx:{display:o?"flex":"none"},children:e.jsxs(P,{severity:"warning",icon:!1,children:[e.jsx(Ie,{children:"Note:"}),e.jsxs(oe,{children:["Withdraw fee"," ",e.jsx(v,{type:"coin",number:o==null?void 0:o.withdrawalMinFee,coin:n==null?void 0:n.typeId})," ","will be applicable, and Minimum withdraw Amount is"," ",e.jsx(v,{type:"coin",number:o==null?void 0:o.withdrawalMinSize,coin:n==null?void 0:n.typeId})]})]})}),e.jsx(b,{item:!0,xs:12,children:c?e.jsx(ae,{sx:{width:"fit-content"},children:"Withdraw"}):e.jsx(k,{component:ie,to:`${N.base}kyc/warning`,variant:"contained",sx:{mt:{lg:"auto !important"},mb:{lg:0}},children:"Withdraw"})})]})},Oe=()=>{const{state:t}=O(),c=le(),p=M(),n=K,{verified:m}=ve(!1),{chains:d,loading:a}=Me(t==null?void 0:t.typeId),s=ce().shape({blockChain:V().notOneOf(["0"],"Please choose blockchain").required("Blockchain is required"),amount:$().max((t==null?void 0:t.balance)-Math.abs(t==null?void 0:t.freeze),"Insufficient Balance").when("blockChain",(o,g)=>{var i;const x=(i=d==null?void 0:d.chainList)==null?void 0:i.find(r=>r.chainName===o);return x?g.min(x==null?void 0:x.withdrawalMinSize,`Minimum withdraw amount is ${x==null?void 0:x.withdrawalMinSize}`):g}),toAddress:V().required("No Withdraw address provided"),finalWithdrawAmount:$(),otp:$().min(6,"Minimum 6 digit needed").typeError("Invalid OTP").required("OTP required to transfer")}),j=async({amount:o,toAddress:g,otp:x,blockChain:i},{setSubmitting:r})=>{await D("cryptoPayout",{type:t==null?void 0:t.type,coin:t.typeId,amount:o,network:i,walletAddress:g,otp:x}).then(l=>{n({message:l.error?l.message:"Withdraw Successful",variant:l.error?l!=null&&l.isPending?"warning":"error":"success"}),l.error||(c.invalidateQueries("userCoinWallet"),r(!1),p(".."))}).catch(()=>{n({message:"Something went wrong, Please try again later",variant:"error"})})};return console.log("NETWORK",t==null?void 0:t.network),a?e.jsx(A,{}):t?e.jsxs(J,{icon:!0,children:[e.jsxs(ee,{children:[e.jsx(h,{variant:"h5",children:"Withdraw"}),e.jsx(L,{})]}),e.jsx(Y,{children:e.jsx(de,{initialValues:{blockChain:"0",amount:"",toAddress:"",finalWithdrawAmount:"",otp:""},validationSchema:s,onSubmit:j,children:()=>e.jsxs(me,{children:[e.jsx(R,{direction:"row",node:!0,medium:!0,title:`${t==null?void 0:t.typeId} Balance`,label:e.jsx(v,{type:"coin",number:(t==null?void 0:t.balance)-Math.abs(t==null?void 0:t.freeze),coin:t==null?void 0:t.typeId})}),e.jsx(ze,{chainList:t==null?void 0:t.network,verified:m})]})})})]}):e.jsx(xe,{to:".."})},Pe=()=>{var i,r,l,C,f,B;const{coinList:t}=ue.useContext(Z),[c,p]=y.useState((t==null?void 0:t[0])||null),{state:n}=O(),{contentCopy:m}=fe(),d=y.useMemo(()=>{var u;return((u=n==null?void 0:n.network)==null?void 0:u.split(";").filter(Boolean))||[]},[n==null?void 0:n.network]),[a,s]=y.useState(d[0]||""),j=y.useRef(null),{walletDetail:o,loading:g}=$e((c==null?void 0:c.coinId)||"",n==null?void 0:n.type,a);y.useEffect(()=>{var u,I,E,U;if((I=(u=o==null?void 0:o.userWallet)==null?void 0:u[0])!=null&&I.network){const q=(U=(E=o==null?void 0:o.userWallet)==null?void 0:E[0])==null?void 0:U.network.split(";").filter(Boolean);q.length>0&&s(te=>te||q[0])}},[(r=(i=o==null?void 0:o.userWallet)==null?void 0:i[0])==null?void 0:r.network]),y.useEffect(()=>{a&&a!==j.current&&(j.current=a)},[a]);const x=u=>{const I=u.target.value;s(I),setTimeout(()=>{console.log("Updated Selected Network:",I)},0)};return n?g&&(n==null?void 0:n.walletAddress)===""?e.jsx(A,{}):e.jsxs(J,{maxWidth:"xs",icon:!0,children:[e.jsxs(ee,{children:[e.jsxs(w,{direction:"row",gap:1,children:[e.jsx(h,{variant:"h6",children:"Deposit"}),e.jsxs(h,{sx:{mt:.5},variant:"subtitle1",color:"text.secondary",children:["(",n==null?void 0:n.typeId,")"]})]}),e.jsx(L,{sx:{mt:1}})]}),e.jsxs(w,{component:Y,justifyContent:"center",alignItems:"center",spacing:2,children:[e.jsxs(w,{sx:{p:3,width:"auto",bgcolor:u=>`${u.palette.warning.light}20`,borderRadius:2,border:u=>`0px solid ${u.palette.warning.light}50`,justifyContent:"center",alignItems:"center"},children:[e.jsx(he,{value:`${a}:${((C=(l=o==null?void 0:o.userWallet)==null?void 0:l[0])==null?void 0:C.walletAddress)||""}`,size:160}),e.jsx(h,{align:"center",children:"Scan this QR code to deposit"})]}),e.jsxs(S,{sx:{display:"flex",alignItems:"baseline"},children:[e.jsx(h,{align:"center",textTransform:"capitalize",children:"Network :"}),d.length>0?e.jsx(pe,{variant:"standard",sx:{m:1,minWidth:120},children:e.jsx(ge,{labelId:"network-select-label",id:"network-select",value:a,onChange:x,label:"Network",sx:{textTransform:"capitalize"},children:d.map(u=>e.jsx(_,{value:u,sx:{textTransform:"capitalize"},children:u},u))})}):null]}),e.jsx(je,{variant:"outlined",size:"small",value:((B=(f=o==null?void 0:o.userWallet)==null?void 0:f[0])==null?void 0:B.walletAddress)||"Unable to fetch wallet address, Please Try Again Later",sx:{borderRadius:1,bgcolor:"primary.main","& fieldset":{borderWidth:0},"& input":{color:"#fff"}},InputProps:{endAdornment:e.jsx(W,{position:"end",children:e.jsx(z,{onClick:()=>{var u,I;return m(((I=(u=o==null?void 0:o.userWallet)==null?void 0:u[0])==null?void 0:I.walletAddress)||"Unable to fetch wallet address, Please try again later")},children:e.jsx(Fe,{sx:{color:"#fff"}})})})},contentEditable:!1,fullWidth:!0}),e.jsxs(P,{severity:"info",icon:!1,children:[e.jsx(h,{variant:"subtitle1",noWrap:!0,children:"Note:"}),e.jsx(h,{variant:"caption",children:"Scan this QR code to deposit the required amount in your wallet. Please verify your account details before initiating the transaction."})]})]})]}):e.jsx(A,{})},Be=({coinWalletDetails:t,amountWalletDetails:c,nativeCurrency:p,mainCurrency:n,nativePrice:m})=>{var g,x,i;const d=M(),a=(c==null?void 0:c.find(({typeId:r})=>r===n))||{balance:0,freeze:0,typeId:n},s=(i=(x=(g=t==null?void 0:t.filter(({currency:r})=>r===n))==null?void 0:g.filter(({type:r})=>r==="COIN"))==null?void 0:x.map(r=>r.current_price*(r.balance-Math.abs(r.freeze))*m))==null?void 0:i.reduce((r,l)=>r+l,0),j=()=>{console.log("opening");const r=`${N.base}wallet/deposit`,l=t.find(({type:C,currency:f})=>C==="COIN"&&f===n);console.log("Navigating to:",r),console.log("Main Currency:",n),console.log("Selected Coin:",l),console.log("Coin ID:",(l==null?void 0:l.coinId)||"No Coin ID Found"),console.log("Data before navigation:",a),d(r,{state:{...a,coinId:l==null?void 0:l.coinId,type:"AMOUNT"}})},o=()=>{var r;return d(`${N.base}wallet/withdraw`,{state:{...a,coinId:(r=t.find(({type:l,currency:C})=>l==="COIN"&&C===n))==null?void 0:r.coinId,type:"AMOUNT"}})};return e.jsx(X,{id:"mainCurrency",direction:"column",spacing:2,sx:{height:"100%",p:{xs:3,sm:5}},children:e.jsxs(w,{direction:{xs:"column",sm:"row"},alignItems:{sm:"center"},justifyContent:"space-between",spacing:5,children:[e.jsxs(w,{direction:"row",spacing:2,alignItems:"center",id:"totalBalance",children:[e.jsx(z,{size:"large",disableRipple:!0,sx:{border:1,borderColor:"primary.light"},children:e.jsx(T,{src:"/images/wallet.png",component:"img",sx:{width:30,height:30}})}),e.jsx(R,{title:"Total Balance",label:e.jsx(h,{variant:"h5",children:e.jsx(v,{type:"coin",number:a.balance-Math.abs(a.freeze),coin:a==null?void 0:a.typeId})}),node:!0,medium:!0})]}),e.jsxs(w,{direction:"row",spacing:2,alignItems:"center",id:"estimatedValue",children:[e.jsx(z,{size:"large",disableRipple:!0,sx:{border:1,borderColor:"primary.light"},children:e.jsx(T,{src:"/images/walletusd.png",component:"img",sx:{width:30,height:30}})}),e.jsx(R,{title:"Total Asset Value",label:e.jsx(h,{variant:"h5",children:e.jsx(v,{type:p,number:s+(a.balance-Math.abs(a.freeze))*m})}),node:!0,medium:!0})]}),e.jsx(S,{flexGrow:{xs:0,sm:1}}),e.jsxs(w,{gap:2,direction:"row",children:[e.jsx(k,{id:"mainCurrencyDeposit",variant:"contained",onClick:j,startIcon:e.jsx(T,{src:"images/Deposit.png",component:"img",sx:{width:20,height:20}}),sx:{bgcolor:"#00C566",borderRadius:2.5,py:1.25,px:3,"&:hover":{bgcolor:"#00C566",boxShadow:"none"}},children:"Deposit"}),e.jsx(k,{id:"mainCurrencyWithdraw",disabled:(a==null?void 0:a.balance)-Math.abs(a==null?void 0:a.freeze)<=0,variant:"contained",color:"warning",onClick:o,startIcon:e.jsx(T,{src:"images/Withdraw.png",component:"img",sx:{width:20,height:20}}),sx:{bgcolor:"#FCB923",borderRadius:2.5,py:1.25,px:3,"&:hover":{bgcolor:"#FCB923",boxShadow:"none"}},children:"Withdraw"})]})]})})},Ee=({coinWalletDetails:t,nativeCurrency:c,mainCurrency:p,nativePrice:n,syncedAccount:m,nfts:d})=>{const[a,s]=y.useState("crypto"),j=M(),o=r=>j("deposit",{state:r}),g=r=>j("withdraw",{state:r}),x=r=>j(`${N.base}exchange/${r.id}`,{state:r}),i=t!=null&&t.length?t.filter((r,l,C)=>l===C.findIndex(f=>f.typeId===r.typeId)).map((r,l)=>({coin:e.jsxs(w,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(T,{component:"img",src:`https://api.sun100.io${`${r.coinLogo}`.replaceAll("//","/")}`,sx:{width:50,borderRadius:20}}),e.jsxs(w,{children:[e.jsx(h,{variant:"body2",noWrap:!0,fontWeight:"bolder",children:r.coinName}),e.jsx(h,{variant:"body2",color:"text.secondary",children:r.coin})]})]},l),amount:e.jsx(v,{number:r.balance-Math.abs(r.freeze),type:"coin",coin:r.coin}),price:e.jsx(v,{number:(r.balance-Math.abs(r.freeze))*r.current_price*n,type:c}),freeze:e.jsx(v,{number:Math.abs(r.freeze),type:"coin",coin:r.coin}),action:e.jsxs(w,{direction:{xs:"column",sm:"row"},alignItems:"center",justifyContent:"space-between",children:[e.jsx(F,{id:"cryptoDeposit",sx:{color:"#00C566",textDecoration:"none"},component:k,onClick:()=>o(r),children:"Deposit"}),e.jsx(F,{id:"cryptoWithdraw",disabled:r.balance-Math.abs(r.freeze)<=0,sx:{color:"warning.main"},component:k,onClick:()=>g(r),children:"Withdraw"})]},l),mode:e.jsx(w,{direction:{xs:"column",sm:"row"},alignItems:"center",justifyContent:"space-between",children:e.jsx(F,{id:"cryptoTrade",sx:{textDecoration:"none",color:"text.primary"},disabled:!(r.type==="COIN"&&r.active),component:k,onClick:()=>x(r),children:r.type==="COIN"&&r.active?`Trade by ${r.currency}`:"Unavailable"})},l)})):[];return e.jsxs(X,{direction:"column",spacing:2,children:[e.jsx(h,{variant:"h6",fontWeight:900,children:"My Assets"}),e.jsxs(P,{severity:"info",sx:{mb:1,display:a=="nft"?"flex":"none"},children:[e.jsx("b",{children:"NOTE:"})," If you lost your wallet post a query in help center to change your meta mask wallet address."]}),e.jsx(Se,{id:"assetType",sx:{overflow:"hidden",width:"fit-content",bgcolor:"background.default"},children:e.jsxs(k,{variant:"text",onClick:()=>s("crypto"),sx:{color:"text.secondary",position:"relative",px:3,fontWeight:"bold"},children:["Cryptos",a==="crypto"&&e.jsx(S,{sx:{position:"absolute",bottom:0,width:50,borderRadius:2,borderBottom:r=>`2px solid ${r.palette.primary.main}`}})]})}),{crypto:e.jsx(Ne,{id:"availableCryptos",titles:["COIN","AMOUNT","PRICE","P2P ESCROW","ACTION","MODE"],data:i}),nft:e.jsx(Re,{account:m||"",syncedAccount:m||"",nfts:d,hide:!0})}[a],e.jsx(S,{flexGrow:1})]})},Ue=()=>{const{coinWalletDetails:t,amountWalletDetails:c,mainCurrency:p,nativeCurrency:n,nativePrice:m,loading:d,syncedAccount:a,nfts:s}=y.useContext(Z);return d||s===void 0?e.jsx(A,{}):e.jsxs(be,{maxWidth:"xl",sx:{px:{xs:2,md:5},pb:5},children:[e.jsx(Ae,{name:"wallet"}),e.jsx(h,{variant:"h6",noWrap:!0,sx:{fontWeight:900},children:"Balance Details"}),e.jsxs(b,{container:!0,spacing:2,children:[e.jsx(b,{item:!0,xs:12,children:e.jsx(Be,{coinWalletDetails:t,amountWalletDetails:c,nativeCurrency:n,mainCurrency:p,nativePrice:m})}),e.jsx(b,{item:!0,xs:12,children:e.jsx(Ee,{coinWalletDetails:t,nativeCurrency:n,mainCurrency:p,nativePrice:m,syncedAccount:a||"",nfts:s})})]}),e.jsx(b,{item:!0,spacing:2,sx:{mt:3},children:e.jsx(Te,{transactions:[]})}),e.jsx(we,{})]})},tt=()=>ye([{path:"/*",element:e.jsx(Ue,{}),children:[{path:"deposit",element:e.jsx(Pe,{})},{path:"withdraw",element:e.jsx(Oe,{})}]}]);export{tt as default};
