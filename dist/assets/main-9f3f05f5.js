import{b8 as N,j as e,t as R,S as r,T as d,G as b,P as _,A as H,F as w,R as $,$ as v,b9 as U,v as M,f as z,B as S,U as q,l as F,a0 as W,o as A,x as D,p as V,q as J,O as Y,H as K,m as P}from"./index-4567d11c.js";import{O as Q,a as X}from"./tableView-9874d410.js";import{u as B}from"./use-utils-f92e6887.js";import{R as E}from"./responsive-table-d0b9fcb6.js";import{C as L}from"./CopyAll-c77268ed.js";import{I as k}from"./intro-7f65460b.js";import{F as Z}from"./FiberManualRecord-493f7776.js";import{B as ee}from"./ButtonGroup-1d56cd83.js";import"./TableRow-90bf4727.js";import"./Pagination-09178b23.js";const ne=()=>{const{data:i,isFetching:o}=N(["getUserTransactions",localStorage.getItem("accessToken")||""],"getUserTransactions");return{transactions:i,loading:o}},te=({coinWalletDetails:i,nativeCurrency:o,mainCurrency:h,nativePrice:p})=>{const x=(i==null?void 0:i.filter(({type:s,coin:l,currency:g})=>{const u=g===h||l===h;return console.log("Filtering by currency:",{type:s,coin:l,currency:g,match:u}),u}))||[],c=x.filter((s,l,g)=>{const u=l===g.findIndex(f=>f.typeId===s.typeId);return console.log("Filtering Unique:",{value:s,isUnique:u}),u}),t=c.length%2===0?c:[...c,{}];return console.log("Filtered By Currency:",x),console.log("Unique Filtered Data:",c),console.log("Final Data:",t),e.jsxs(R,{direction:"column",justifyContent:"start",spacing:2,sx:{height:"100%"},id:"coinDetails",children:[e.jsx(r,{direction:{xs:"column",md:"row",lg:"row"},justifyContent:"space-between",spacing:1,children:e.jsx(d,{variant:"h5",fontWeight:900,children:"Portfolio"})}),e.jsx(r,{sx:{width:"100%",overflow:"auto"},children:e.jsxs(b,{container:!0,gap:1.25,sx:{pb:2,width:`${310*(t.length/2)}px !important`,borderRadius:2,overflow:"auto"},children:[t.filter((s,l)=>l%2===0).map((s,l)=>s!=null&&s.coin?e.jsx(b,{item:!0,xs:!0,children:e.jsx(O,{coin:s.coinLogo,coinName:s.coin,balance:s.balance-Math.abs(s.freeze),amountType:o,amount:s.current_price*p})},l):null),t.filter((s,l)=>l%2===1).map((s,l)=>s!=null&&s.coin?e.jsx(b,{item:!0,xs:!0,children:e.jsx(O,{coin:s.coinLogo,coinName:s.coin,balance:s.balance-Math.abs(s.freeze),amountType:o,amount:s.current_price*p})},l):null)]})})]})},O=({coin:i,coinName:o,balance:h,amountType:p,amount:x})=>e.jsxs(r,{direction:"row",alignItems:"center",component:_,gap:4,sx:{p:1.25,width:293,height:90,borderRadius:2,border:"1px solid #eeeeee",bgcolor:c=>c.palette.mode==="dark"?void 0:"#fff"},children:[e.jsx(r,{children:e.jsx(r,{direction:"row",spacing:1,children:e.jsx(H,{src:`https://api.sun100.io/${i}`,sx:{height:35,width:35}})})}),e.jsxs(r,{direction:"row",justifyContent:"space-between",alignItems:"baseline",width:"100%",children:[e.jsxs(r,{spacing:1,gap:1.25,children:[e.jsx(r,{direction:"row",spacing:1,children:e.jsx(d,{variant:"body1",children:o})}),e.jsx(r,{direction:"row",gap:2,children:e.jsx(d,{variant:"h6",noWrap:!0,sx:{fontWeight:800,fontSize:"18px"},children:e.jsx(w,{type:p,number:x})})})]}),e.jsx(d,{variant:"h6",sx:{fontWeight:800,fontSize:"18px"},children:e.jsx(w,{type:"number",number:h})})]})]}),ie=({transactions:i})=>{const{contentCopy:o}=B(),[h,p]=$.useState(""),x=t=>p(t.target.value),c=i?i.sort((t,s)=>new Date(s.createdAt).getTime()-new Date(t.createdAt).getTime()).filter(t=>`${t.type} ${t.currency} ${t.address} ${t.amount} ${t.transactionId} ${t.status}}`.toLowerCase().includes(h.toLowerCase())).map(t=>({date:t.createdAt,type:e.jsx(d,{variant:"inherit",align:"left",children:t.type}),symbol:t.currency,amount:e.jsx(w,{type:"number",number:t.amount}),transactionId:e.jsxs(r,{direction:"row",alignItems:"center",id:"copyContent",children:[e.jsxs(d,{variant:"inherit",width:200,noWrap:!0,children:[t.transactionId," "]}),e.jsx(v,{size:"small",onClick:()=>o(t.transactionId),children:e.jsx(L,{fontSize:"inherit",color:"primary"})})]}),status:e.jsxs(d,{color:{completed:"success.light",success:"success.light",failed:"error.light",pending:"warning.main"}[t.status],textTransform:"capitalize",variant:"inherit",children:[e.jsx(U,{sx:{fontSize:8}})," ",t.status]})})):[];return e.jsxs(R,{direction:"column",spacing:2,children:[e.jsx(d,{variant:"h6",fontWeight:900,children:"Recent Transactions"}),e.jsx(r,{direction:{xs:"column",md:"row"},alignItems:"center",spacing:1,sx:{width:"100%"},children:e.jsx(M,{id:"transactionFilter",size:"small",value:h,onChange:x,placeholder:"Search transactions",InputProps:{startAdornment:e.jsx(z,{component:"img",src:"images/search.png",sx:{width:25,height:25}})},sx:{"& .MuiOutlinedInput-root":{borderRadius:"20px","& .MuiOutlinedInput-input":{padding:"10px 14px"}}}})}),e.jsx(E,{titles:["Date","Type","Symbol","Amount","Transaction REF","Status"],data:c}),e.jsx(S,{flexGrow:1})]})},se=({account:i,trades:o,p2p_trades:h,logs:p,contentCopy:x})=>{var C,a,m;const{user:c}=$.useContext(q),[t,s]=$.useState("spot"),[l,g]=$.useState(""),u=n=>g(n.target.value);h&&h.filter(n=>`${n.coin} ${n.currency} ${n.noOfCoins} ${n.pricePerCoin} ${n.prefferedPayment} ${n.status}`.toLowerCase().includes(l.toLowerCase())).map(n=>{const y=n.orderType==="buy"&&(n==null?void 0:n.uid)===(c==null?void 0:c.uid)||n.orderType==="sell"&&(n==null?void 0:n.requestuid)!==(c==null?void 0:c.uid);return{id:e.jsxs(r,{direction:"row",alignItems:"center",children:[e.jsxs(d,{variant:"inherit",width:100,noWrap:!0,children:[n.tradeId," "]}),e.jsx(v,{size:"small",onClick:()=>x(n.tradeId),children:e.jsx(L,{fontSize:"inherit",color:"primary"})})]}),date:n.showPostTill,type:e.jsx(d,{sx:{bgcolor:j=>y?`${j.palette.success.light}30`:`${j.palette.error.light}30`,py:.5,px:2,borderRadius:1,width:"fit-content",textTransform:"capitalize"},color:y?"success.light":"error.light",variant:"inherit",children:y?"Buy":"Sell"}),pair:`${n.coin}-${n.currency}`,limit:`${n.quantityLimitFrom}-${n.quantityLimitTo}`,quantity:n.requestCoins,paymentType:+n.prefferedPayment==0?"All Payments":n.prefferedPayment,status:e.jsxs(r,{direction:"row",children:[e.jsx(Z,{color:{cancelled:"error",pending:"error",partiallyPending:"error",dispute:"error",declined:"error",expired:"warning",ongoing:"warning",confirm:"success",confirmed:"success",completed:"success",undefined:void 0}[n==null?void 0:n.requestStatus],sx:{width:8,mx:.5}}),e.jsx(d,{color:{cancelled:"error.main",dispute:"error.main",pending:"error.main",partiallyPending:"error.main",declined:"error.main",expired:"warning.main",ongoing:"warning.main",confirm:"success.main",confirmed:"success.main",completed:"success.main"}[n==null?void 0:n.requestStatus],variant:"body2",sx:{textTransform:"capitalize"},children:n.requestStatus})]})}});const f=p?p.sort((n,y)=>y.time-n.time).filter(n=>`${n.tokenId} ${n.logType} ${n.from} ${n.to} ${n.price}`.toLowerCase().includes(l.toLowerCase())).map(n=>({date:n.time,id:`# ${n.tokenId}`,contract:e.jsxs(r,{direction:"row",alignItems:"center",children:[e.jsxs(d,{variant:"inherit",width:100,noWrap:!0,children:[n.contract," "]}),e.jsx(v,{size:"small",onClick:()=>x(n.contract),children:e.jsx(L,{fontSize:"inherit",color:"primary"})})]}),logType:e.jsx(d,{variant:"inherit",textTransform:"capitalize",children:n.logType}),from:n.from,to:n.to,price:e.jsx(w,{type:"coin",number:n.price,coin:"ETH"}),gasFee:e.jsx(w,{type:"coin",number:n.fee,coin:"ETH"})})):[];return e.jsxs(R,{direction:"column",spacing:2,customTitle:e.jsxs(r,{sx:{width:"100%"},children:[e.jsx(d,{variant:"h6",flexGrow:0,fontWeight:900,children:"Trade History"}),e.jsxs(r,{direction:{xs:"column",md:"row"},alignItems:"center",spacing:1,sx:{width:"100%"},children:[e.jsx(ee,{id:"tradeHistoryNavigations",sx:{overflow:"hidden",width:"fit-content",bgcolor:"background.default"},children:e.jsxs(F,{variant:"text",onClick:()=>s("spot"),sx:{color:t==="spot"?"primary.main":"text.secondary",position:"relative",px:3,fontWeight:"bold"},children:["Spot"," ",(C=o==null?void 0:o.filter(({status:n})=>["completed","FILLED","done"].includes(n)))!=null&&C.length?`(${(a=o==null?void 0:o.filter(({status:n})=>["completed","FILLED","done"].includes(n)))==null?void 0:a.length})`:"",t==="spot"&&e.jsx(S,{sx:{position:"absolute",bottom:0,width:50,borderRadius:2,borderBottom:n=>`2px solid ${n.palette.primary.main}`}})]})}),e.jsx(S,{flexGrow:1}),e.jsx(M,{size:"small",value:l,onChange:u,placeholder:"Filter records",InputProps:{startAdornment:e.jsx(z,{component:"img",src:"images/search.png",sx:{width:25,height:25}})},sx:{"& .MuiOutlinedInput-root":{borderRadius:"20px","& .MuiOutlinedInput-input":{padding:"10px 14px"}}}})]})]}),children:[{spot:e.jsx(Q,{trades:(m=o.filter(n=>`${n.baseAsset} ${n.quoteAsset} ${W[(n.orderType||n.orderTypeId)-1]} ${n.noOfCoins} ${(n==null?void 0:n.noOfCoinsAsset)||(n==null?void 0:n.coin)} ${["FILLED","done"].includes(n.status)?"completed":n.status}`.toLowerCase().includes(l.toLowerCase())))==null?void 0:m.filter(({status:n})=>["completed","FILLED","done"].includes(n)),type:"trades"}),token:i?e.jsx(E,{titles:["Time","Token ID","Contract","Log Type","From","To","Price","Gas Fee"],data:f}):e.jsx(r,{justifyContent:"center",alignItems:"center",children:window.ethereum?e.jsx(oe,{}):e.jsx(re,{})})}[t],e.jsx(S,{flexGrow:1})]})},fe=()=>{const{user:i,coinWalletDetails:o,amountWalletDetails:h,nativeCurrency:p,mainCurrency:x,nativePrice:c,loading:t,account:s,logs:l}=$.useContext(q),{contentCopy:g}=B(),{transactions:u,loading:f}=ne(),{trades:C,loading:a}=X(i==null?void 0:i.uid),{data:m}=A("collection","p2p_trade_book").collectionSnapshot(),{data:n}=A("collectionGroup","p2p_request_trades").collectionSnapshot([D("requestPlacedTime","asc")]),y=n?n.map(({uid:j,...T})=>{const I=m==null?void 0:m.find(({tradeId:G})=>G===T.requestTradeId);return{...I,...T,orderType:j===(i==null?void 0:i.uid)?(I==null?void 0:I.orderType)==="buy"?"sell":"buy":I==null?void 0:I.orderType}}).filter(({coin:j})=>!!j):[];return t||f||a||y===void 0?e.jsx(V,{}):e.jsxs(J,{maxWidth:"xl",sx:{px:{xs:2,md:5},pb:5},children:[e.jsx(k,{name:"dashboard"}),e.jsxs(b,{container:!0,spacing:2,children:[e.jsx(b,{item:!0,xs:12,md:3,children:e.jsx(ce,{coinWalletDetails:o,amountWalletDetails:h,nativeCurrency:p,mainCurrency:x,nativePrice:c})}),e.jsx(b,{item:!0,xs:12,md:9,children:e.jsx(te,{coinWalletDetails:o,nativeCurrency:p,mainCurrency:x,nativePrice:c})}),e.jsx(b,{item:!0,xs:12,children:e.jsx(ie,{transactions:u.transactions})}),e.jsx(b,{item:!0,xs:12,children:e.jsx(se,{contentCopy:g,account:s,trades:C,p2p_trades:y.filter(({requestuid:j,uid:T})=>[j,T].includes(i==null?void 0:i.uid)).sort((j,T)=>T.requestPlacedTime-j.requestPlacedTime),logs:l})})]}),e.jsx(Y,{})]})},oe=()=>{const{account:i,balance:o,connect:h,authenticated:p,syncedAccount:x}=$.useContext(q),{contentCopy:c}=B();return i?e.jsx(e.Fragment,{children:e.jsxs(r,{id:"metamaskBalance",sx:{borderRadius:5,border:t=>`1px solid ${t.palette.grey[200]}`,p:1},children:[e.jsx(k,{name:"nftBalance"}),e.jsxs(r,{direction:"row",alignItems:"center",children:[e.jsxs(d,{variant:"inherit",width:200,noWrap:!0,children:["ID: ",i," "]}),e.jsx(v,{size:"small",onClick:()=>c(i),children:e.jsx(L,{fontSize:"inherit",color:"primary"})})]}),e.jsx(d,{variant:"body2",color:"primary",children:p?e.jsxs(e.Fragment,{children:["Balance:"," ",e.jsx(w,{number:o,type:"coin",coin:"ETH"})]}):x?"Account not synced with this user":""})]})}):e.jsxs(F,{id:"connectMetamask",variant:"outlined",sx:{borderRadius:20,width:"fit-content",height:"fit-content"},onClick:h,children:[e.jsx(k,{name:"nftConnect"}),"Connect to Wallet"]})},re=()=>e.jsx(F,{variant:"outlined",sx:{borderRadius:20},download:!0,href:"https://metamask.io/download.html",children:"Install MetaMask"}),ce=({coinWalletDetails:i,amountWalletDetails:o,nativeCurrency:h,mainCurrency:p,nativePrice:x})=>{var u,f,C;const c=K(),t=(o==null?void 0:o.find(({typeId:a})=>a===p))||{balance:0,freeze:0,typeId:p},s=(C=(f=(u=i==null?void 0:i.filter(({currency:a})=>a===p))==null?void 0:u.filter(({type:a})=>a==="COIN"))==null?void 0:f.map(a=>a.current_price*(a.balance-Math.abs(a.freeze))*x))==null?void 0:C.reduce((a,m)=>a+m,0),l=()=>{var a;return c(`${P.base}wallet/deposit`,{state:{...t,coinId:(a=i.find(({type:m})=>m==="COIN"))==null?void 0:a.coinId}})},g=()=>{var a;return c(`${P.base}wallet/withdraw`,{state:{...t,coinId:(a=i.find(({type:m})=>m==="COIN"))==null?void 0:a.coinId}})};return e.jsxs(R,{direction:"column",spacing:2,id:"mainCurrency",sx:{height:"100%"},children:[e.jsx(r,{direction:"row",alignItems:"center",gap:1.5,children:e.jsx(d,{variant:"h6",noWrap:!0,sx:{color:"#818898"},children:"Available Balance"})}),e.jsxs(r,{direction:"row",justifyContent:"space-between",sx:{mt:0},children:[e.jsx(d,{variant:"h5",fontWeight:700,children:e.jsx(w,{type:"number",number:t.balance-Math.abs(t.freeze)})}),e.jsx(d,{variant:"h5",sx:{color:"#005E00",opacity:.8},children:t==null?void 0:t.typeId})]}),e.jsx(r,{children:e.jsx(d,{variant:"h6",noWrap:!0,sx:{color:"#818898"},children:"Total Asset Value"})}),e.jsx(r,{direction:"row",justifyContent:"space-between",children:e.jsx(d,{variant:"h5",children:e.jsx(w,{type:h,number:s+(t.balance-Math.abs(t.freeze))*x})})}),e.jsxs(r,{direction:"row",alignItems:"center",justifyContent:"space-between",spacing:1,children:[e.jsx(F,{id:"mainCurrencyDeposit",variant:"contained",size:"small",sx:{bgcolor:"#00C566",borderRadius:2.5,py:1.25,px:3,"&:hover":{bgcolor:"#00C566",boxShadow:"none"}},onClick:l,startIcon:e.jsx(z,{src:"images/Deposit.png",component:"img",sx:{width:20,height:20}}),children:"Deposit"}),e.jsx(F,{id:"mainCurrencyWithdraw",disabled:(t==null?void 0:t.balance)-Math.abs(t==null?void 0:t.freeze)<=0,variant:"contained",size:"small",sx:{bgcolor:"#FCB923",borderRadius:2.5,py:1.25,px:3,"&:hover":{bgcolor:"#FCB923",boxShadow:"none"}},startIcon:e.jsx(z,{src:"images/Withdraw.png",component:"img",sx:{width:20,height:20}}),onClick:g,children:"Withdraw"})]})]})};export{fe as default};
